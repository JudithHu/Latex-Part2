% an octave script to try SSA analysis of our seasonal SOI data.
% Note the extraction of a 5-6 year cycle in the signal
% Tony Roberts  24/11/94 -- 2015
%
s=[3.7
-18.2333
-4.63333
7.7
0.866667
-1.86667
0.866667
-11.9667
-1.6
-0.06667
-1.1
-10.1
-0.2
-8.83333
-12.3
1.133333
5.466667
7.9
12.5
11.76667
4.133333
4.266667
1.766667
-0.96667
-13.7
-12.7
-11.9667
-11.0333
-9.1
7.3
12.6
17.2
7.166667
-0.16667
5.233333
3.233333
-1.86667
-5.26667
-4.53333
-5.1
8.166667
9.633333
9.433333
5.966667
5.333333
12.06667
7.466667
4.8
3.366667
3.9
6.166667
0.233333
1.666667
-1.2
-0.7
1.166667
-17.8333
-22.3667
-16.3333
-12.4333
-15.6667
-0.56667
-1.7
7.033333
7.766667
1.766667
0.166667
6.533333
2.833333
-8.06667
6.8
-6.6
-15.5
12.9
-13.0333
-1.8
3.733333
9.766667
-15.3667
3.366667
7.866667
-1.7
-9.23333
-8.6
12.5
1.633333
4.833333
14.73333
14.76667
-4.66667
-4.86667
-9.03333
-33.4
-18.1667
-9.7
-9.03333
-2.06667
5.733333
16.2
1.766667
-2
-4.06667
-0.76667
-2.6
2.6
-0.7
9.433333
-4.7
-4
12.8
4.833333
7.8
5.233333
15.6
15
5.966667
-1.23333
-11.3667
-9.03333
-10.6667
-13.1667
-4.46667
-3.06667
-6.56667
-4.3
-4.16667
-9.83333
-4.36667
-4
-11.8333
-12.4
-8.1
-5.2
6.066667
-7.13333
2.933333
-0.13333
15.46667
6.833333
9.4
18.33333
25.7
21.8
17.26667
7.233333
-7.23333
-3.76667
-12.5333
-7.2
-8.03333
-8.9
-3.96667
-2.2
6.3
0.3
8.333333
7.4
1.633333
7.866667
7.633333
-1.73333
1.833333
6.6
6.4
5.566667
-9.26667
-10.8
-1.63333
-0.46667
7.8
9.266667
7.5
8.033333
-9.06667
-9.3
-10.1
-7.13333
-4.9
2.566667
3.233333
9
-0.13333
-4
1.9
6.5
0.533333
6.733333
14.7
-1.2
0.666667
6.333333
7.933333
-0.2
-3.63333
-0.23333
-4.26667
8.033333
9.533333
2.5
-2.5
-1.76667
2.366667
-5.66667
-1.93333
2.1
-0.3
4.4
4.066667
-0.66667
-3.23333
3.766667
-1.16667
2.1
-0.26667
5.966667
-2.73333
8.333333
-2.03333
-3.53333
0.633333
2.033333
0.166667
-1.06667
5
3.833333
14.83333
7.633333
12.06667
5.633333
1.8
-10.4667
-5.3
-10.7667
-16.3
-14.6333
-19.3333
-8.8
-16.7
-12.4333
-9.43333
-1.9
3.133333
4.633333
10.46667
5.833333
0.933333
6.4
-5.2
-0.5
-2.93333
-4.03333
4.366667
1.466667
7
2.733333
2
-7.2
-7.43333
-9.03333
-5.83333
-2.43333
5.766667
6.266667
-1.13333
0.5
-2.6
1.233333
-4.5
-0.03333
-5.5
0.8
9.3
12.03333
18
12.26667
13.36667
-8.13333
-6.5
-10.6667
-8.43333
0.4
2.7
0.7
-6.1
-10.7667
-6.53333
-5.33333
-2
2.266667
3.4
2.266667
6.866667
2.466667
14.33333
15.43333
10.26667
10.86667
10.56667
7.766667
3.266667
-4.76667
-2.86667
-6.9
-9.63333
-3.4
3.466667
-2.63333
-10.4
5.1
-4.43333
5.466667
1.8
5.466667
2.766667
4.9
2.833333
-3.6
-1.06667
4.2
7.933333
2.733333
3.066667
6.6
3.8
5.066667
-5.06667
-9.93333
-6.4
4.566667
8.366667
10.16667
-2.56667
-2.9
-14
-13.7333
-3
-8.86667
1.466667
-1.2
7.3
0.033333
3.666667
0.3
1.966667
2.566667
5.533333
-2.46667
-7.16667
-4.83333
-3.83333
-7.26667
-6.86667
-0.43333
2.433333
14.2
11.23333
14.96667
5.766667
13.73333
3.7
-9.33333
-12.1333
-9.5
-10.6667
0.233333
9.166667
18.43333
17.3
12.33333
6.366667
6.633333
-0.33333
9.3
17.36667
17.96667
13.8
4.633333
-7.63333
0.133333
-5.16667
-8.96667
-13.6
-11.9667
-13.9667
0.8
3.9
-2.1
-0.2
-1.6
4.5
-1.7
-1.8
-7.6
-1.33333
-3
-1.43333
-4.13333
8.433333
1.133333
4
-2.9
-19.1
-23.5
-29.9
-11.9
-3.1
4.6
1.566667
-1.63333
-1.73333
0.4
-0.36667
4.3
-0.93333
-2.1
-1.3
-1.76667
1.2
-3.86667
-12
-19.7333
-16.1
-5.8
-4.5
2.7
6.933333
18.73333
10.23333
12.9
3
3.933333
-8.53333
1.566667
0.266667
-4.5
0.1
-13.1667
-4.6
-12.2
-18.2
-12.7333
-5.86667
-8.06667
-8.16667];
m=993+3.5/12+(-length(s)+1:0)'/12;
disp('Soi data series');
figure(1),plot(m,s)

disp('SSA analysis with window width (ssons)')
w=48 
wm=(1:w)';

disp('Forming n pictures');
n=length(s)-w+1 
x=zeros(w,n);
for p=1:n
   x(:,p)=s(p-1+wm);
end;

disp('SVD of the pictures');
[u,sv,a]=svd(x);
a=a(:,1:w);
disp('log_10 of singular values versus window mode');
sv=diag(sv);
figure(2),plot(wm,log10(sv+eps))

disp('lowest 4 modes');
figure(3),plot(wm,u(:,1:4))

a=diag(sv)*a';
disp('component of 1:4 in signal');
figure(4),plot(1:n, u(w,1:4)*a(1:4,:) )


